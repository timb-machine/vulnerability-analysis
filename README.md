# vulnerability-analysis

## Playing with alternative scoring systems

### VESS

* VESS.xlsx - Vulnerability Exploitability Scoring System

#### Metrics

* Ease of exploitation
  
  * Acts on - Are you attacking your own state or someone elses? The latter should be harder since there's a deputy to confuse
  
  * Vector - Are you directly attacking a network socket or feeding an artefact into an unfriendly process? The more complicated the means by which you introduce the artefact, the harder it ought to be
  
  * Authentication required - Do you require credentials for the exact step that you are trying to perform? This is not the same as needing authentication to reach this point e.g. a MySQL client may still need credentials even if you're sitting at a shell prompt
  
  * Vulnerable data structure - How complicated is the data structure you're manipulating and how well is documented? The thinking is that proprietary, undocumented data structures are always going to take more work than for example injecting into a human readable file structure
  
  * Attack state complexity - How complicated is the state that you're manupulating? Injecting into a one shot command is likely going to be easier than manipulating a stack (which would be a direct state change) which in turn is going to be easier than grooming a heap (which is likely to indirectly lead to state changes)
  
  * Attack repeatability - What happens when you get it wrong? Can you try again?

* Value of success

  * Platform - The more common the target, the more targets you'll have to exploit with a reliable exploit
  
  * Affects hosts - Does the exploit get you access to just the host on which it is introduced? Does it get you access to the wider application, system or service? Does it get you access to management capabilities?
  
  * Yields privileges - Does the exploit give you some particular extra privilege? Does the exploit give you someone else's privileges? Does the exploit simply give you more control but with the same fundamental privilege as before? Think about arbitrary code execution into a network service that doesn't in itself operate a separate privilege model on top of whatever the OS is providing
  
  * Confidentiality - Can you determine state? Can you read the data that the vulnerable code is processing?
  
  * Integrity - Can you interfere with state? Can you change the data that the vulnerable code is processing?
  
  * Availability - Can you break with state? Can you damage the data that the vulnerable code is processing?

* Difficulty of defence

  * Detect - How likely is it that you'll be spotted and how sophisticated does the means of detection need to be?

  * Fix - Fixing a config should be quicker/easier than being reliant on a vendor supplied patch?

### Mapping CVSS to kill chain phases

* cvss-to-kill-chain-phase.pl - CVSS to kill chain phase mapper

## ATT&CK vulnerability analysis

* attack-to-cve.py - ATT&CK to CVE estractor

  * Top 10 bugs

```
grep "used" | cut -f 1 -d " " | sort | uniq -c | sort -n | tail -n 10
```

  * Bugs by year

```
grep "CVSS" | cut -f 2 -d "-" | sort | uniq -c | sort -n
```

  * Bugs by score

```
grep "CVSS" | cut -f 5 -d " " | sort | uniq -c | sort -n
```

  * Bugs by type

```
grep "CVSS" | cut -f 7 -d " " | sort | uniq -c | sort -n
```

  * Bugs by access vector

```
grep "CVSS" | cut -f 2 -d "/" | sort | uniq -c | sort -n
```

  * Bugs by complexity

```
grep "CVSS" | cut -f 3 -d "/" | sort | uniq -c | sort -n
```

  * Bugs by privileges required

```
grep "CVSS" | cut -f 4 -d "/" | sort | uniq -c | sort -n
```

  * Bugs by user interaction

```
grep "CVSS" | cut -f 5 -d "/" | sort | uniq -c | sort -n
```

## ATT&CK properties

* ATT&CK properties.xlsx - Which artefacts have which properties?

## Vulnerability bingo

* Vulnerability bingo.xlsx - A slightly tongue in cheek look at the vulnerability disclosure process
